{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\HP\\\\Documents\\\\GitHub\\\\TheBarakMart-An-Ecommerce-website\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\HP\\\\Documents\\\\GitHub\\\\TheBarakMart-An-Ecommerce-website\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\HP\\\\Documents\\\\GitHub\\\\TheBarakMart-An-Ecommerce-website\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\HP\\\\Documents\\\\GitHub\\\\TheBarakMart-An-Ecommerce-website\\\\src\\\\context\\\\AuthContext.js\";\n\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { useUserContext } from \"../hook/index\";\nimport axios from \"axios\";\nimport { checkInputField, validateEmail, validatePassword, validateUsername, isMatch } from \"../utils\";\nimport { SIGNUP_API, LOGIN_API } from \"../urls\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLogin = _useState2[0],\n      setLogin = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      token = _useState6[0],\n      setToken = _useState6[1];\n\n  var navigate = useNavigate();\n\n  var _useLocation = useLocation(),\n      state = _useLocation.state;\n\n  var _useUserContext = useUserContext(),\n      users = _useUserContext.state.users;\n\n  useEffect(function () {\n    var _localStorage;\n\n    var loginStatus = JSON.parse((_localStorage = localStorage) === null || _localStorage === void 0 ? void 0 : _localStorage.getItem(\"login\"));\n    (loginStatus === null || loginStatus === void 0 ? void 0 : loginStatus.isUserLoggedIn) ? setLogin(true) : setLogin(false);\n  }, []);\n\n  var handleLogOut = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              localStorage.removeItem(\"token\");\n              setToken(\"\");\n              navigate(\"/products\");\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleLogOut() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleLogin = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(username, password) {\n      var _yield$axios$post, data, t;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n\n              if (checkInputField(username) === \"EMPTY\") {\n                setError(\"username cannot be empty\");\n              }\n\n              if (checkInputField(password) === \"EMPTY\") {\n                setError(\"password cannot be empty\");\n              }\n\n              _context2.next = 5;\n              return axios.post(LOGIN_API, {\n                username: username,\n                password: password\n              });\n\n            case 5:\n              _yield$axios$post = _context2.sent;\n              data = _yield$axios$post.data;\n              console.log(\"handleLogin\", data);\n\n              if (data.success) {\n                t = localStorage.setItem(\"token\", JSON.stringify(data.token));\n                setToken(t);\n              }\n\n              _context2.next = 15;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](0);\n              alert(_context2.t0);\n              console.log(\"handleLogin\", _context2.t0);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 11]]);\n    }));\n\n    return function handleLogin(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleSignUp = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(username, email, password, confirmPassword) {\n      var _yield$axios$post2, data, t;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n\n              if (!(checkInputField(username) === \"EMPTY\")) {\n                _context3.next = 3;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"username cannot be Empty\"));\n\n            case 3:\n              if (!(checkInputField(email) === \"EMPTY\")) {\n                _context3.next = 5;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"email cannot be Empty\"));\n\n            case 5:\n              if (!(checkInputField(password) === \"EMPTY\")) {\n                _context3.next = 7;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"password cannot be Empty\"));\n\n            case 7:\n              if (isMatch(password, confirmPassword)) {\n                _context3.next = 9;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"Password and ConfirmPassword Should Match\"));\n\n            case 9:\n              if (validateEmail(email)) {\n                _context3.next = 11;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"Enter a valid Email\"));\n\n            case 11:\n              if (validatePassword(password)) {\n                _context3.next = 13;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"Password should contain atleast 6 characters of atleast lowercase, uppercase and numeric integer\"));\n\n            case 13:\n              if (validateUsername(username)) {\n                _context3.next = 15;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", setError(\"Enter a valid Username\"));\n\n            case 15:\n              _context3.next = 17;\n              return axios.post(SIGNUP_API, {\n                username: username,\n                email: email,\n                password: password\n              });\n\n            case 17:\n              _yield$axios$post2 = _context3.sent;\n              data = _yield$axios$post2.data;\n              console.log(\"handleSignUp\", data);\n\n              if (data.success) {\n                t = localStorage.setItem(\"token\", JSON.stringify(data.token));\n                setToken(t);\n              }\n\n              _context3.next = 27;\n              break;\n\n            case 23:\n              _context3.prev = 23;\n              _context3.t0 = _context3[\"catch\"](0);\n              alert(_context3.t0);\n              console.log(\"handleSignUp\", _context3.t0);\n\n            case 27:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 23]]);\n    }));\n\n    return function handleSignUp(_x3, _x4, _x5, _x6) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      isLogin: isLogin,\n      handleSignUp: handleSignUp,\n      handleLogin: handleLogin,\n      handleLogOut: handleLogOut,\n      setLogin: setLogin,\n      error: error,\n      setError: setError,\n      token: token,\n      setToken: setToken\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, children);\n};","map":{"version":3,"sources":["C:/Users/HP/Documents/GitHub/TheBarakMart-An-Ecommerce-website/src/context/AuthContext.js"],"names":["React","createContext","useState","useEffect","useNavigate","useLocation","useUserContext","axios","checkInputField","validateEmail","validatePassword","validateUsername","isMatch","SIGNUP_API","LOGIN_API","AuthContext","AuthProvider","children","isLogin","setLogin","error","setError","token","setToken","navigate","state","users","loginStatus","JSON","parse","localStorage","getItem","isUserLoggedIn","handleLogOut","removeItem","handleLogin","username","password","post","data","console","log","success","t","setItem","stringify","alert","handleSignUp","email","confirmPassword"],"mappings":"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","sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { useUserContext } from \"../hook/index\";\r\nimport axios from \"axios\";\r\nimport {\r\n  checkInputField,\r\n  validateEmail,\r\n  validatePassword,\r\n  validateUsername,\r\n  isMatch,\r\n} from \"../utils\";\r\n\r\nimport { SIGNUP_API, LOGIN_API } from \"../urls\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [isLogin, setLogin] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [token, setToken] = useState(\"\");\r\n\r\n  const navigate = useNavigate();\r\n  const { state } = useLocation();\r\n  const {\r\n    state: { users },\r\n  } = useUserContext();\r\n\r\n  useEffect(() => {\r\n    const loginStatus = JSON.parse(localStorage?.getItem(\"login\"));\r\n\r\n    loginStatus?.isUserLoggedIn ? setLogin(true) : setLogin(false);\r\n  }, []);\r\n\r\n  const handleLogOut = async () => {\r\n    localStorage.removeItem(\"token\");\r\n    setToken(\"\");\r\n    navigate(\"/products\");\r\n  };\r\n\r\n  const handleLogin = async (username, password) => {\r\n    try {\r\n      if (checkInputField(username) === \"EMPTY\") {\r\n        setError(\"username cannot be empty\");\r\n      }\r\n      if (checkInputField(password) === \"EMPTY\") {\r\n        setError(\"password cannot be empty\");\r\n      }\r\n\r\n      const { data } = await axios.post(LOGIN_API, { username, password });\r\n\r\n      console.log(\"handleLogin\", data);\r\n\r\n      if (data.success) {\r\n        const t = localStorage.setItem(\"token\", JSON.stringify(data.token));\r\n        setToken(t);\r\n      }\r\n    } catch (error) {\r\n      alert(error);\r\n      console.log(\"handleLogin\", error);\r\n    }\r\n  };\r\n\r\n  const handleSignUp = async (username, email, password, confirmPassword) => {\r\n    try {\r\n      if (checkInputField(username) === \"EMPTY\") {\r\n        return setError(`username cannot be Empty`);\r\n      }\r\n\r\n      if (checkInputField(email) === \"EMPTY\") {\r\n        return setError(`email cannot be Empty`);\r\n      }\r\n\r\n      if (checkInputField(password) === \"EMPTY\") {\r\n        return setError(`password cannot be Empty`);\r\n      }\r\n\r\n      if (!isMatch(password, confirmPassword)) {\r\n        return setError(\"Password and ConfirmPassword Should Match\");\r\n      }\r\n\r\n      if (!validateEmail(email)) {\r\n        return setError(\"Enter a valid Email\");\r\n      }\r\n\r\n      if (!validatePassword(password)) {\r\n        return setError(\r\n          \"Password should contain atleast 6 characters of atleast lowercase, uppercase and numeric integer\"\r\n        );\r\n      }\r\n\r\n      if (!validateUsername(username)) {\r\n        return setError(\"Enter a valid Username\");\r\n      }\r\n\r\n      const { data } = await axios.post(SIGNUP_API, {\r\n        username,\r\n        email,\r\n        password,\r\n      });\r\n\r\n      console.log(\"handleSignUp\", data);\r\n      if (data.success) {\r\n        const t = localStorage.setItem(\"token\", JSON.stringify(data.token));\r\n        setToken(t);\r\n      }\r\n    } catch (error) {\r\n      alert(error);\r\n      console.log(\"handleSignUp\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        isLogin,\r\n        handleSignUp,\r\n        handleLogin,\r\n        handleLogOut,\r\n        setLogin,\r\n        error,\r\n        setError,\r\n        token,\r\n        setToken,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}